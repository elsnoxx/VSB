@model ParkingLotWEB.Models.ResetPassword
@{
    ViewData["Title"] = "Reset hesla";
    var user = ViewBag.User as ParkingLotWEB.Models.User;
}
<h2 class="mb-4">Reset hesla uživatele</h2>

@if (user != null)
{
    <div class="alert alert-info">
        <strong>@user.Username</strong> (@user.FirstName @user.LastName, @user.Email)
    </div>
}

<form asp-action="ResetPassword" method="post" class="needs-validation" novalidate>
    <input type="hidden" asp-for="Id" />
    
    <div class="mb-3 position-relative">
        <label asp-for="Password" class="form-label"></label>
        <div class="input-group">
            <input asp-for="Password" class="form-control" autocomplete="new-password" required id="passwordInput" />
            <button type="button" class="btn btn-outline-secondary" onclick="togglePassword('passwordInput', this)">
                <i class="bi bi-eye"></i>
            </button>
        </div>
        <span asp-validation-for="Password" class="text-danger"></span>
    </div>

    <div class="mb-3 position-relative">
        <label asp-for="ConfirmPassword" class="form-label"></label>
        <div class="input-group">
            <input asp-for="ConfirmPassword" class="form-control" autocomplete="new-password" required id="confirmPasswordInput" />
            <button type="button" class="btn btn-outline-secondary" onclick="togglePassword('confirmPasswordInput', this)">
                <i class="bi bi-eye"></i>
            </button>
        </div>
        <span asp-validation-for="ConfirmPassword" class="text-danger"></span>
    </div>

    <div class="d-flex justify-content-start">
        <button type="submit" class="btn btn-warning">Resetovat heslo</button>
        @if (user != null)
        {
            <a asp-action="Index" class="btn btn-secondary ms-2">Zpět na seznam uživatelů</a>
        }
        else
        {
            <a asp-controller="User" asp-action="Profil" asp-route-id="@user.Id" class="btn btn-secondary ms-2">Zpět na profil</a>
        }
    </div>
</form>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        function togglePassword(inputId, button) {
            const input = document.getElementById(inputId);
            const icon = button.querySelector('i');
            if (input.type === "password") {
                input.type = "text";
                icon.classList.remove('bi-eye');
                icon.classList.add('bi-eye-slash');
            } else {
                input.type = "password";
                icon.classList.remove('bi-eye-slash');
                icon.classList.add('bi-eye');
            }
        }
    </script>
}
